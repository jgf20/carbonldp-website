<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:aop="http://www.springframework.org/schema/aop"
	xsi:schemaLocation="http://www.springframework.org/schema/beans
		http://www.springframework.org/schema/beans/spring-beans.xsd
		http://www.springframework.org/schema/aop
	    http://www.springframework.org/schema/aop/spring-aop.xsd
">

	
	<!-- 
	<bean class="org.springframework.beans.factory.config.CustomScopeConfigurer">
	    <property name="scopes">
	        <map>
	            <entry key="thread">
	                <bean class="org.springframework.context.support.SimpleThreadScope"/>
	            </entry>
	        </map>
	    </property>
	</bean>
	
	 -->

	<!--
	*********************************************************************************************************
	SERVICE BEANS
	*********************************************************************************************************
	-->
	
	<bean name="configurationService" class="com.base22.carbon.ConfigurationService" init-method="init"></bean>
	
	<!-- bean name="repositoryService" class="com.base22.carbon.services.RepositoryServiceFactory" factory-method="create" scope="thread" -->
	 <bean name="repositoryService" class="com.base22.carbon.repository.RepositoryServiceFactory" factory-method="create">
		<!-- Change this value to toggle between the repository configuration -->
		<constructor-arg value="TDB"></constructor-arg>
		<constructor-arg>
			<map>
				<entry key="TDB">
					<bean class="com.base22.carbon.repository.services.TDBRepositoryService">
						<property name="datasetDirectory" value="/opt/carbon/TDB/" />
					</bean>
				</entry>
			</map>
		</constructor-arg>
		<aop:scoped-proxy/>
	</bean>
	
	<!-- bean name ="sparqlService" class="com.base22.carbon.services.SparqlService" init-method="init" scope="thread" -->
	<!-- bean name ="rdfService" class="com.base22.carbon.services.RdfService" init-method="init" scope="thread" -->
	<!-- bean name ="ldpService" class="com.base22.carbon.services.LDPService" init-method="init" scope="thread" -->
	
	<bean name="sparqlService" class="com.base22.carbon.sparql.SPARQLService" init-method="init" scope="request">
		<property name="repositoryService" ref="repositoryService" />
		<aop:scoped-proxy/>
	</bean>

	<bean name="modelService" class="com.base22.carbon.repository.services.ModelService" init-method="init" scope="request">
		<property name="repositoryService" ref="repositoryService" />
		<property name="sparqlService" ref="sparqlService" />
		<aop:scoped-proxy/>
	</bean>
	
	<bean name="ldpService" class="com.base22.carbon.repository.services.LDPService" init-method="init" scope="request">
		<property name="sparqlService" ref="sparqlService" />
		<property name="modelService" ref="modelService" />
		<aop:scoped-proxy/>
	</bean>
</beans>
